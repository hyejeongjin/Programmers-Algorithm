-- 코드를 입력하세요
# SELECT CAR_ID,
#     CASE WHEN END_DATE < '2022-10-16' THEN '대여 가능'
#          WHEN END_DATE >='2022-10-16' THEN '대여중'
# END AVAILABILITY,
# END_DATE
# FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY
# ORDER BY CAR_ID DESC;

SELECT CAR_ID, 
     CASE WHEN MAX(CASE WHEN 
                   START_DATE <= '2022-10-16' AND END_DATE >= '2022-10-16' THEN '1'
          ELSE 0
          END) = 1
   THEN '대여중'
   ELSE '대여 가능'
   END AS AVAILABILITY                 
FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY
GROUP BY CAR_ID
ORDER BY CAR_ID DESC;

# SELECT CAR_ID,
#        CASE WHEN MAX(START_DATE) <='2022-10-16' AND MAX(END_DATE) >= '2022-10-16' THEN '대여중'
#        ELSE '대여 가능'
#        END AVAILABILITY
# FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY
# GROUP BY CAR_ID
# ORDER BY CAR_ID DESC;
